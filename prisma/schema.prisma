generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String    @id @default(cuid())
  fullName      String?
  phone         String?   @unique
  email         String?   @unique
  password      String?
  role          String    @default("USER")
  refreshTokens String?
  weddings      Wedding[]
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
}

model Wedding {
  id                String      @id @default(cuid())
  userId            String
  groomName         String
  brideName         String
  weddingDate       DateTime
  weddingLocation   String
  invitationStyle   String      @default("classic")
  language          String      @default("UZ")
  slug              String      @unique
  qrCodeUrl         String?
  user              User        @relation(fields: [userId], references: [id])
  invitations       Invitation[]
  gifts             Gift[]
  media             Media[]
  createdAt         DateTime    @default(now())
  updatedAt         DateTime    @updatedAt
}

model Invitation {
  id           String   @id @default(cuid())
  weddingId    String
  content      String
  language     String
  aiGenerated  Boolean  @default(true)
  wedding      Wedding  @relation(fields: [weddingId], references: [id])
  createdAt    DateTime @default(now())
}

model Gift {
  id          String   @id @default(cuid())
  weddingId   String
  guestName   String
  amount      Float
  message     String?
  wedding     Wedding  @relation(fields: [weddingId], references: [id])
  createdAt   DateTime @default(now())
}

model Media {
  id               String   @id @default(cuid())
  weddingId        String
  fileUrl          String
  type             String
  uploadedByGuest  Boolean  @default(true)
  wedding          Wedding  @relation(fields: [weddingId], references: [id])
  createdAt        DateTime @default(now())
}
